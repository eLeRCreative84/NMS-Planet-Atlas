<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Proste Planety</title>
<script src="https://unpkg.com/three"></script>
<script src="https://unpkg.com/globe.gl"></script>
<style>
  body 
  { margin:0; display:flex; height:100vh; font-family:Arial; }
#form { width:250px; min-width:250px; max-width:300px; background:#0a1e3a; color:white; padding:1rem; overflow:auto; flex-shrink:0; }
#globeViz { flex:1; }
  button { width:100%; margin-top:0.5rem; }
  input { width:100%; margin-top:0.3rem; }
</style>
</head>
<body>

<div id="form">
  <h3>Dodaj planetę</h3>
  <input type="text" id="planetName" placeholder="Nazwa planety">
  <button onclick="addPlanet()">Dodaj planetę</button>

  <h3>Planety</h3>
  <div id="planetList"></div>

  <h3>Tekstura planety</h3>
  <input type="text" id="textureUrl" placeholder="Wpisz URL PNG">
  <button onclick="setTexture()">Ustaw teksturę</button>
</div>

<div id="globeViz"></div>

<script>
let atlas = {};
let currentPlanet = null;

// inicjalizacja globu
const globe = Globe()(document.getElementById("globeViz"))
  .globeImageUrl(null)
  .backgroundImageUrl('https://unpkg.com/three-globe/example/img/night-sky.png');

function addPlanet() {
  const name = document.getElementById("planetName").value.trim();
  if(!name) return;
  if(atlas[name]) { alert("Planeta już istnieje!"); return; }

  atlas[name] = { texture: null };
  currentPlanet = name;
  refreshPlanetList();
  updateGlobeTexture();
  document.getElementById("planetName").value = "";
}

function refreshPlanetList() {
  const div = document.getElementById("planetList");
  div.innerHTML = "";
  Object.keys(atlas).forEach(name => {
    const btn = document.createElement("button");
    btn.textContent = name;
    btn.onclick = () => {
      currentPlanet = name;
      updateGlobeTexture();
    };
    div.appendChild(btn);
  });
}

function setTexture() {
  if(!currentPlanet) { alert("Wybierz planetę"); return; }
  const url = document.getElementById("textureUrl").value.trim();
  if(!url) return;
  atlas[currentPlanet].texture = url;
  updateGlobeTexture();
}

function updateGlobeTexture() {
  if(currentPlanet && atlas[currentPlanet].texture) {
    globe.globeImageUrl(atlas[currentPlanet].texture);
  } else {
    globe.globeImageUrl(null);
  }
}
</script>

</body>
</html>
