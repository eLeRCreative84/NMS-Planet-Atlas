<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Prosty Atlas Planet</title>
<script src="https://unpkg.com/globe.gl"></script>
<style>
  html, body { margin:0; padding:0; width:100%; height:100%; font-family: Arial; overflow:hidden; }
  #hud { position:absolute; top:0; left:0; width:300px; height:100%; background:#0a1e3a; color:white; padding:1rem; box-sizing:border-box; overflow:auto; }
  #globeViz { position:absolute; top:0; left:300px; right:0; bottom:0; background:black; }
  input, button { width:100%; margin-top:0.5rem; padding:0.4rem; box-sizing:border-box; }
</style>
</head>
<body>

<div id="hud">
  <h2>Planety</h2>
  <input type="text" id="planetName" placeholder="Nazwa planety">
  <button onclick="addPlanet()">Dodaj planetę</button>

  <h3>Lista planet</h3>
  <div id="planetList"></div>

  <h3>Tekstura planety</h3>
  <input type="text" id="planetTexture" placeholder="URL tekstury">
  <button onclick="setTexture()">Ustaw teksturę</button>
</div>

<div id="globeViz"></div>

<script>
const atlas = {};
const planetTextures = {};
let currentPlanet = null;

const globe = Globe()(document.getElementById('globeViz'))
  .globeImageUrl(null); // początkowo brak tekstury

function updatePlanetList(){
  const list = document.getElementById('planetList');
  list.innerHTML = '';
  Object.keys(atlas).forEach(p=>{
    const btn = document.createElement('button');
    btn.textContent = p;
    btn.style.marginTop = "0.3rem";
    btn.onclick = () => { currentPlanet = p; applyTexture(); };
    list.appendChild(btn);
  });
}

function addPlanet(){
  const name = document.getElementById('planetName').value.trim();
  if(!name) return alert("Wpisz nazwę planety!");
  if(atlas[name]) return alert("Planeta już istnieje!");
  atlas[name] = {};
  currentPlanet = name;
  updatePlanetList();
  applyTexture();
}

function setTexture(){
  if(!currentPlanet) return alert("Wybierz planetę!");
  const url = document.getElementById('planetTexture').value.trim();
  if(!url) return alert("Wpisz URL tekstury!");
  planetTextures[currentPlanet] = url;
  applyTexture();
}

function applyTexture(){
  if(!currentPlanet) return;
  const url = planetTextures[currentPlanet];
  globe.globeImageUrl(url || null); // klucz: używamy globImageUrl() bez TextureLoader
}
</script>

</body>
</html>
